#!/bin/sh

# Change working directory to the directory of the script.
cd `dirname $0`

# Make sure 'build-initrd' is empty, so that we won't overwrite files.
if [ -d "build-initrd" -a -n "`ls -A "build-initrd"`" ]; then
    echo "ERROR: Directory 'build-initrd' is not empty."
    # exit 1
fi

if [ ! -f "initrd.gz" ]; then
    echo "File initrd.gz is not found. Please place the CPUstress initrd image in the "
    echo "same directory as this script."
    exit
fi

echo "Extracting initrd.gz..."
gzip -d -v -c initrd.gz >build-initrd/initrd
cd build-initrd
cpio -i -m <initrd
rm initrd
echo "Done."
